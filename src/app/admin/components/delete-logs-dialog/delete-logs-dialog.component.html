<!-- delete-logs-dialog.component.html - OPTIMIZADO ANGULAR 20 + MATERIAL + TAILWIND -->

<div class="max-w-[700px] min-w-[600px]">
  
  <!-- ============================================
       HEADER
       ============================================ -->
  <div class="text-center px-6 pt-6 pb-4">
    <div class="warning-icon w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-red-100 to-red-200 rounded-full flex items-center justify-center">
      <mat-icon class="!text-[36px] !w-[36px] !h-[36px] text-red-600">delete_sweep</mat-icon>
    </div>
    <h2 mat-dialog-title class="text-2xl font-bold text-slate-800 m-0">üóëÔ∏è Eliminar Logs del Sistema</h2>
  </div>

  <!-- ============================================
       CONTENT
       ============================================ -->
  <mat-dialog-content class="dialog-content px-6 pb-6 max-h-[70vh] overflow-y-auto">
    <div class="flex flex-col gap-5">
      
      <!-- Informaci√≥n de logs totales -->
      <div class="flex items-center gap-4 px-5 py-4 bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-300 rounded-xl">
        <mat-icon class="!text-[28px] !w-[28px] !h-[28px] text-blue-500 flex-shrink-0">info</mat-icon>
        <div class="flex flex-col gap-1.5 flex-1">
          @if (isLoadingCount) {
            <span class="text-sm font-medium text-blue-800">Cargando informaci√≥n...</span>
            <mat-spinner diameter="20"></mat-spinner>
          } @else {
            <span class="text-sm font-medium text-blue-800">Total de logs en el sistema:</span>
            <span class="text-[22px] font-bold text-slate-800">{{ totalLogs }} registros</span>
          }
        </div>
      </div>

      <!-- Opciones de eliminaci√≥n -->
      <div class="flex flex-col gap-4">
        <label class="flex items-center gap-2.5 text-[15px] font-semibold text-slate-800">
          <mat-icon class="!text-[20px] !w-[20px] !h-[20px] text-purple-500">tune</mat-icon>
          Selecciona el m√©todo de eliminaci√≥n:
        </label>

        <mat-radio-group 
          [(ngModel)]="selectedOption" 
          class="options-radio-group flex flex-col gap-3">
          
          <!-- Opci√≥n: Eliminar logs antiguos -->
          <mat-radio-button 
            value="older_than" 
            class="option-card">
            <div class="option-content ml-9">
              <div class="flex items-center gap-3 mb-2">
                <mat-icon class="!text-2xl text-purple-500">schedule</mat-icon>
                <span class="text-base font-semibold text-slate-800">Eliminar logs antiguos</span>
              </div>
              <p class="text-sm text-slate-500 m-0 leading-relaxed">
                Elimina logs con m√°s de X d√≠as de antig√ºedad (recomendado)
              </p>
              
              @if (selectedOption === 'older_than') {
                <div class="flex flex-col gap-2 mt-4 pt-4 border-t border-dashed border-slate-200">
                  <label class="flex items-center gap-2 text-sm font-semibold text-slate-700">
                    <mat-icon class="!text-lg text-purple-500">calendar_today</mat-icon>
                    D√≠as de antig√ºedad
                  </label>
                  <div class="relative">
                    <input 
                      type="number" 
                      class="w-full h-12 px-4 pr-12 border-2 border-slate-200 rounded-xl text-base font-semibold text-slate-800 bg-white focus:border-purple-500 focus:ring-2 focus:ring-purple-100 outline-none transition-all"
                      [(ngModel)]="daysInput"
                      min="1"
                      max="365"
                      placeholder="30">
                    <mat-icon class="absolute right-4 top-1/2 -translate-y-1/2 text-purple-500">event</mat-icon>
                  </div>
                  <span class="text-sm text-slate-500 font-medium text-center px-2 py-2 bg-slate-50 rounded-lg border border-slate-200">
                    üí° Se recomienda mantener logs de al menos 30 d√≠as
                  </span>
                </div>
              }
            </div>
          </mat-radio-button>

          <!-- Opci√≥n: Eliminar TODOS -->
          <mat-radio-button 
            value="all" 
            class="option-card danger-option">
            <div class="option-content ml-9">
              <div class="flex items-center gap-3 mb-2">
                <mat-icon class="option-icon danger !text-2xl">warning</mat-icon>
                <span class="text-base font-semibold text-slate-800">Eliminar TODOS los logs</span>
              </div>
              <p class="text-sm text-red-900 font-semibold m-0 leading-relaxed">
                ‚ö†Ô∏è PELIGRO: Esto eliminar√° TODOS los {{ totalLogs }} logs del sistema sin excepci√≥n
              </p>
            </div>
          </mat-radio-button>
        </mat-radio-group>
      </div>

      <!-- Advertencias -->
      <div class="flex flex-col gap-3 bg-amber-50 border border-amber-200 rounded-xl p-4">
        <div class="flex items-start gap-3 text-amber-900 text-sm font-medium">
          <mat-icon class="!text-[20px] !w-[20px] !h-[20px] text-red-600 flex-shrink-0 mt-0.5">error</mat-icon>
          <span>Esta acci√≥n <strong>NO se puede deshacer</strong></span>
        </div>
        <div class="flex items-start gap-3 text-amber-900 text-sm font-medium">
          <mat-icon class="!text-[20px] !w-[20px] !h-[20px] text-red-600 flex-shrink-0 mt-0.5">delete_forever</mat-icon>
          <span>{{ getWarningMessage() }}</span>
        </div>
        <div class="flex items-start gap-3 text-amber-900 text-sm font-medium">
          <mat-icon class="!text-[20px] !w-[20px] !h-[20px] text-red-600 flex-shrink-0 mt-0.5">history</mat-icon>
          <span>Se perder√° el historial de auditor√≠a de estas acciones</span>
        </div>
      </div>

      <!-- Confirmaci√≥n de seguridad -->
      <div class="bg-gradient-to-br from-amber-50 to-amber-100 border-2 border-amber-300 rounded-2xl p-6 shadow-[0_4px_12px_rgba(234,179,8,0.1)]">
        <p class="text-[15px] font-semibold text-amber-900 m-0 mb-4 text-center flex items-center justify-center gap-2 flex-wrap">
          <span>Para confirmar, escribe:</span>
          <span class="keyword-badge bg-gradient-to-br from-red-600 to-red-700 text-white px-4 py-1.5 rounded-lg font-bold text-sm tracking-wider shadow-[0_4px_12px_rgba(220,38,38,0.3)]">
            {{ getRequiredKeyword() }}
          </span>
        </p>
        
        <div class="flex flex-col gap-2">
          <div class="input-container relative w-full">
            <div class="absolute left-4 top-1/2 -translate-y-1/2 z-10 flex items-center justify-center w-6 h-6">
              <mat-icon class="input-icon !text-[20px] !w-[20px] !h-[20px] text-slate-400">
                {{ confirmationText.toUpperCase() === getRequiredKeyword().toUpperCase() ? 'check_circle' : 'edit' }}
              </mat-icon>
            </div>
            <input 
              class="confirmation-input-custom w-full px-4 pl-[52px] py-4 border-2 border-slate-200 rounded-xl text-[15px] font-semibold font-mono tracking-wider bg-white text-slate-800 uppercase outline-none"
              [(ngModel)]="confirmationText"
              [disabled]="isDeleting"
              (keyup.enter)="onConfirm()"
              [placeholder]="'Escribe ' + getRequiredKeyword() + ' aqu√≠...'"
              autocomplete="off"
              [class.valid]="confirmationText.toUpperCase() === getRequiredKeyword().toUpperCase()"
              [class.invalid]="confirmationText.length > 0 && confirmationText.toUpperCase() !== getRequiredKeyword().toUpperCase()">
          </div>
          
          @if (confirmationText.length > 0) {
            <div class="flex items-center justify-end h-6">
              @if (confirmationText.toUpperCase() === getRequiredKeyword().toUpperCase()) {
                <span class="text-sm font-semibold text-green-600 flex items-center gap-1 animate-fadeInUp">
                  ‚úì Correcto
                </span>
              } @else {
                <span class="text-sm font-semibold text-red-600 flex items-center gap-1 animate-fadeInUp">
                  ‚úó Incorrecto
                </span>
              }
            </div>
          }
        </div>

        @if (confirmationText.length === 0) {
          <div class="text-sm text-amber-900 text-center mt-2 font-medium animate-fadeIn">
            üí° Escribe exactamente la frase indicada para continuar
          </div>
        }
      </div>

    </div>
  </mat-dialog-content>

  <!-- ============================================
       ACTIONS
       ============================================ -->
  <mat-dialog-actions class="px-6 py-4 border-t border-slate-200 flex gap-3 justify-end">
    <button 
      mat-stroked-button 
      (click)="onCancel()"
      [disabled]="isDeleting"
      class="!px-5 !py-2.5 !border-2 !border-slate-200 !text-slate-600 !rounded-xl !text-sm !font-semibold hover:!bg-slate-50 hover:!border-slate-300">
      <mat-icon class="!mr-2">close</mat-icon>
      Cancelar
    </button>
    
    <button 
      mat-raised-button 
      (click)="onConfirm()"
      [disabled]="!canConfirm() || isDeleting"
      class="!px-5 !py-2.5 !bg-gradient-to-br !from-red-600 !to-red-700 !text-white !rounded-xl !text-sm !font-semibold !shadow-[0_4px_12px_rgba(220,38,38,0.25)] hover:!shadow-[0_6px_16px_rgba(220,38,38,0.35)]">
      @if (isDeleting) {
        <mat-spinner diameter="20" class="mr-2"></mat-spinner>
      } @else {
        <mat-icon class="!mr-2">delete_sweep</mat-icon>
      }
      {{ isDeleting ? 'Eliminando...' : 'Confirmar Eliminaci√≥n' }}
    </button>
  </mat-dialog-actions>
  
</div>