<!-- src/app/admin/components/delete-multiple-users-dialog/delete-multiple-users-dialog.component.html -->

<div class="delete-multiple-dialog">
    <!-- Header -->
    <div class="dialog-header">
      <div class="warning-icon">
        <mat-icon>warning</mat-icon>
      </div>
      <h2 mat-dialog-title>‚ö†Ô∏è Eliminar M√∫ltiples Usuarios</h2>
    </div>
  
    <!-- Content -->
    <mat-dialog-content class="dialog-content">
      <div class="warning-message">
        <p class="main-warning">
          Est√°s a punto de <strong>eliminar permanentemente {{ data.count }} usuario(s)</strong>:
        </p>
        
        <!-- Lista de usuarios a eliminar -->
        <div class="users-list-container">
          <div class="users-list-header">
            <mat-icon>people</mat-icon>
            <span>Usuarios seleccionados ({{ data.count }})</span>
          </div>
          
          <div class="users-list">
            @for (user of data.users.slice(0, 5); track user.uid) {
              <div class="user-item">
                <div class="user-avatar-mini" [style.background]="getUserColor(user.email)">
                  {{ getUserInitials(user) }}
                </div>
                <div class="user-item-info">
                  <span class="user-item-name">{{ user.displayName }}</span>
                  <span class="user-item-email">{{ user.email }}</span>
                </div>
                <div class="user-item-role" [class]="'role-' + user.role">
                  {{ user.role.toUpperCase() }}
                </div>
              </div>
            }
            
            @if (data.users.length > 5) {
              <div class="more-users">
                <mat-icon>more_horiz</mat-icon>
                <span>y {{ data.users.length - 5 }} usuario(s) m√°s...</span>
              </div>
            }
          </div>
        </div>
  
        <!-- Advertencias -->
        <div class="warning-list">
          <div class="warning-item">
            <mat-icon class="danger-icon">error</mat-icon>
            <span>Esta acci√≥n <strong>NO se puede deshacer</strong></span>
          </div>
          <div class="warning-item">
            <mat-icon class="danger-icon">delete_forever</mat-icon>
            <span>Se eliminar√°n <strong>todos los datos y permisos</strong> de estos usuarios</span>
          </div>
          <div class="warning-item">
            <mat-icon class="danger-icon">block</mat-icon>
            <span>Los usuarios perder√°n acceso <strong>inmediatamente</strong></span>
          </div>
        </div>
  
        <!-- Confirmaci√≥n de seguridad -->
        <div class="confirmation-section">
          <p class="confirmation-label">
            Para confirmar, escribe: <span class="keyword-badge">ELIMINAR</span>
          </p>
          
          <div class="confirmation-input-wrapper">
            <div class="input-container">
              <div class="input-icon-wrapper">
                <mat-icon class="input-icon">{{ confirmationText.toUpperCase() === 'ELIMINAR' ? 'check_circle' : 'edit' }}</mat-icon>
              </div>
              <input 
                class="confirmation-input-custom"
                [(ngModel)]="confirmationText"
                [disabled]="isDeleting"
                (keyup.enter)="onConfirm()"
                placeholder="Escribe ELIMINAR aqu√≠..."
                autocomplete="off"
                [class.valid]="confirmationText.toUpperCase() === 'ELIMINAR'"
                [class.invalid]="confirmationText.length > 0 && confirmationText.toUpperCase() !== 'ELIMINAR'"
              >
            </div>
            @if (confirmationText.length > 0) {
              <div class="input-status">
                @if (confirmationText.toUpperCase() === 'ELIMINAR') {
                  <span class="status-text">
                    ‚úì Correcto
                  </span>
                } @else {
                  <span class="status-text error">
                    ‚úó Incorrecto
                  </span>
                }
              </div>
            }
          </div>
  
          @if (confirmationText.length === 0) {
            <div class="hint-text">
              üí° Escribe exactamente la palabra indicada para continuar
            </div>
          }
        </div>
      </div>
    </mat-dialog-content>
  
    <!-- Actions -->
    <mat-dialog-actions class="dialog-actions">
      <button 
        mat-stroked-button 
        (click)="onCancel()"
        [disabled]="isDeleting"
        class="cancel-btn">
        <mat-icon>close</mat-icon>
        Cancelar
      </button>
      
      <button 
        mat-raised-button 
        color="warn"
        (click)="onConfirm()"
        [disabled]="!canConfirm() || isDeleting"
        class="delete-btn">
        @if (isDeleting) {
          <mat-spinner diameter="20"></mat-spinner>
        } @else {
          <mat-icon>delete_sweep</mat-icon>
        }
        {{ isDeleting ? 'Eliminando...' : 'Eliminar ' + data.count + ' Usuario(s)' }}
      </button>
    </mat-dialog-actions>
  </div>