<!-- src/app/admin/components/delete-user-dialog/delete-user-dialog.component.html -->

<div class="delete-dialog">
    <!-- Header -->
    <div class="dialog-header">
      <div class="warning-icon">
        <mat-icon>warning</mat-icon>
      </div>
      <h2 mat-dialog-title>‚ö†Ô∏è Confirmar Eliminaci√≥n</h2>
    </div>
  
    <!-- Content -->
    <mat-dialog-content class="dialog-content">
      <div class="warning-message">
        <p class="main-warning">
          Est√°s a punto de <strong>eliminar permanentemente</strong> al usuario:
        </p>
        
        <div class="user-info-box">
          <div class="user-avatar" [style.background]="getUserColor()">
            {{ getInitials() }}
          </div>
          <div class="user-details">
            <div class="user-name">{{ data.user.displayName }}</div>
            <div class="user-email">{{ data.user.email }}</div>
            <div class="user-role" [class]="'role-' + data.user.role">
              <mat-icon>{{ getRoleIcon() }}</mat-icon>
              {{ data.user.role.toUpperCase() }}
            </div>
          </div>
        </div>
  
        <div class="warning-list">
          <div class="warning-item">
            <mat-icon class="danger-icon">error</mat-icon>
            <span>Esta acci√≥n <strong>NO se puede deshacer</strong></span>
          </div>
          <div class="warning-item">
            <mat-icon class="danger-icon">delete_forever</mat-icon>
            <span>Se eliminar√°n todos los datos y permisos del usuario</span>
          </div>
          <div class="warning-item">
            <mat-icon class="danger-icon">block</mat-icon>
            <span>El usuario perder√° acceso inmediatamente al sistema</span>
          </div>
        </div>
  
        <!-- Confirmaci√≥n de seguridad -->
        <div class="confirmation-section">
          <p class="confirmation-label">
            Para confirmar, escribe: <span class="keyword-badge">ELIMINAR</span>
          </p>
          
          <div class="confirmation-input-wrapper">
            <div class="input-container">
              <div class="input-icon-wrapper">
                <mat-icon class="input-icon">{{ confirmationText.toUpperCase() === 'ELIMINAR' ? 'check_circle' : 'edit' }}</mat-icon>
              </div>
              <input 
                class="confirmation-input-custom"
                [(ngModel)]="confirmationText"
                [disabled]="isDeleting"
                (keyup.enter)="onConfirm()"
                placeholder="Escribe ELIMINAR aqu√≠..."
                autocomplete="off"
                [class.valid]="confirmationText.toUpperCase() === 'ELIMINAR'"
                [class.invalid]="confirmationText.length > 0 && confirmationText.toUpperCase() !== 'ELIMINAR'"
              >
            </div>
            @if (confirmationText.length > 0) {
              <div class="input-status">
                @if (confirmationText.toUpperCase() === 'ELIMINAR') {
                  <span class="status-text">
                    ‚úì Correcto
                  </span>
                } @else {
                  <span class="status-text error">
                    ‚úó Incorrecto
                  </span>
                }
              </div>
            }
          </div>
  
          @if (confirmationText.length === 0) {
            <div class="hint-text">
              üí° Escribe exactamente la palabra indicada para continuar
            </div>
          }
        </div>
      </div>
    </mat-dialog-content>
  
    <!-- Actions -->
    <mat-dialog-actions class="dialog-actions">
      <button 
        mat-stroked-button 
        (click)="onCancel()"
        [disabled]="isDeleting"
        class="cancel-btn">
        <mat-icon>close</mat-icon>
        Cancelar
      </button>
      
      <button 
        mat-raised-button 
        color="warn"
        (click)="onConfirm()"
        [disabled]="!canConfirm() || isDeleting"
        class="delete-btn">
        @if (isDeleting) {
          <mat-spinner diameter="20"></mat-spinner>
        } @else {
          <mat-icon>delete_forever</mat-icon>
        }
        {{ isDeleting ? 'Eliminando...' : 'Eliminar Usuario' }}
      </button>
    </mat-dialog-actions>
  </div>