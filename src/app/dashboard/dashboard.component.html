<!-- src/app/dashboard/dashboard.component.html - VERSIÓN CON HEADER MEJORADO -->
<div class="dashboard-container">
  
  <!-- ============================================
       HEADER MEJORADO - IGUAL AL ADMIN
       ============================================ -->
  <header class="header">
    <div class="header-content">
      <div class="header-left">
        <!-- NUEVO: Contenedor del icono -->
        <div class="header-icon-container">
          <mat-icon>dashboard</mat-icon>
        </div>
        <!-- Información del header -->
        <div class="header-info">
          <h1>¡Bienvenido de nuevo! 👋</h1>
          <p *ngIf="!loading && userDashboard">
            <span class="status-dot" [class.recent]="isRecentSession()"></span>
            Última sesión: {{ getLastSession() }}
          </p>
        </div>
      </div>
      
      <div class="header-right">
        <!-- User Badge -->
        <div class="user-badge" *ngIf="!loading && userDashboard">
          <div class="user-avatar">{{ getUserInitials() }}</div>
          <div class="user-info-header">
            <span class="user-name">{{ userDashboard.userInfo.displayName }}</span>
            <span class="user-role-badge">{{ userDashboard.userInfo.role.toUpperCase() }}</span>
          </div>
        </div>
        
        <!-- Action Buttons -->
        <button mat-icon-button 
                class="icon-button" 
                [matBadge]="getNotificationCount()"
                [matBadgeHidden]="getNotificationCount() === 0"
                matBadgeColor="warn"
                matTooltip="Notificaciones"
                (click)="goToNotifications()">
          <mat-icon>notifications</mat-icon>
        </button>
        
        <button mat-icon-button 
                class="icon-button" 
                matTooltip="Configuración"
                (click)="goToSettings()">
          <mat-icon>settings</mat-icon>
        </button>

        <button mat-icon-button 
                class="icon-button" 
                matTooltip="Cerrar sesión" 
                (click)="logout()">
          <mat-icon>logout</mat-icon>
        </button>
      </div>
    </div>
  </header>

   <!-- ============================================
       LOADING STATE
       ============================================ -->
  <div *ngIf="loading" class="loading-section">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Cargando tu dashboard...</p>
  </div>

  <!-- ============================================
       ERROR STATE
       ============================================ -->
  <div *ngIf="error && !loading" class="error-section">
    <mat-icon>error_outline</mat-icon>
    <p>{{ error }}</p>
    <button mat-raised-button color="primary" (click)="refreshData()">
      Reintentar
    </button>
  </div>

  <!-- ============================================
       DASHBOARD CONTENT
       ============================================ -->
  <div *ngIf="!loading && !error && userDashboard">

    <!-- ============================================
         QUICK ACTIONS - PRIORIDAD MÁXIMA
         ============================================ -->
    <section class="quick-actions">
      <div *ngFor="let action of quickActions" 
           class="action-card"
           [class.has-badge]="action.badge"
           (click)="executeQuickAction(action)">
        <div class="action-icon" [class]="action.color">
          <mat-icon>{{ action.icon }}</mat-icon>
          <span *ngIf="action.badge" class="action-badge">{{ action.badge }}</span>
        </div>
        <h3>{{ action.title }}</h3>
        <p>{{ action.description }}</p>
      </div>
    </section>

    <!-- ============================================
         MAIN GRID - 2 COLUMNAS
         ============================================ -->
    <div class="main-grid">
      
      <!-- ============================================
           LEFT COLUMN - OVERVIEW + MÉTRICAS
           ============================================ -->
      <section class="overview-section">
        <h2 class="section-title">
          <mat-icon>dashboard</mat-icon>
          Tu Panel de Control
        </h2>
        
        <!-- Key Metrics Grid -->
        <div class="stats-grid">
          <div *ngFor="let metric of keyMetrics" class="stat-item">
            <div class="stat-label">
              <mat-icon>{{ metric.icon }}</mat-icon>
              {{ metric.label }}
            </div>
            <div class="stat-value">{{ metric.value }}</div>
            <div class="stat-change">{{ metric.change }}</div>
          </div>
        </div>

        <!-- Permisos Compactos -->
        <div class="compact-section">
          <h3 class="section-subtitle">
            <mat-icon>verified</mat-icon>
            Tus Permisos
          </h3>
          <div class="compact-list">
            <div *ngFor="let permission of userDashboard.userInfo.permissions" 
                 class="compact-chip">
              <mat-icon>{{ getPermissionIcon(permission) }}</mat-icon>
              {{ getPermissionLabel(permission) }}
            </div>
            <div *ngIf="userDashboard.userInfo.permissions.length === 0" 
                 class="empty-state-chip">
              Sin permisos asignados
            </div>
          </div>
        </div>

        <!-- Módulos Compactos -->
        <div class="compact-section">
          <h3 class="section-subtitle">
            <mat-icon>apps</mat-icon>
            Módulos Activos
          </h3>
          <div class="compact-list">
            <div *ngFor="let module of userDashboard.userInfo.modules" 
                 class="compact-chip">
              <mat-icon>dashboard</mat-icon>
              {{ module }}
            </div>
            <div *ngIf="userDashboard.userInfo.modules.length === 0" 
                 class="empty-state-chip">
              Sin módulos asignados
            </div>
          </div>
        </div>
      </section>

      <!-- ============================================
           RIGHT COLUMN - ACTIVIDAD RECIENTE
           ============================================ -->
      <section class="activity-section">
        <h2 class="section-title">
          <mat-icon>history</mat-icon>
          Actividad Reciente
        </h2>
        
        <div class="activity-timeline" *ngIf="recentActivities.length > 0">
          <div *ngFor="let activity of recentActivities; let last = last" 
               class="activity-item"
               [class.last]="last">
            <div class="activity-icon-wrapper" [class]="getActivityColor(activity.type)">
              <mat-icon>{{ getActivityIcon(activity.type) }}</mat-icon>
            </div>
            <div class="activity-content">
              <div class="activity-title">{{ activity.description }}</div>
              <div class="activity-time">{{ getRelativeTime(activity.timestamp) }}</div>
            </div>
          </div>
        </div>

        <div *ngIf="recentActivities.length === 0" class="empty-state">
          <mat-icon>inbox</mat-icon>
          <p>No hay actividad reciente</p>
        </div>
      </section>
    </div>

    <!-- ============================================
         INSIGHTS - INFORMACIÓN CONTEXTUAL
         ============================================ -->
    <section class="insights-section">
      <!-- Contact Info -->
      <div class="contact-card">
        <h4>
          <mat-icon>email</mat-icon>
          Contacto
        </h4>
        <p>
          <strong>Email:</strong> {{ userDashboard.userInfo.email }}
        </p>
        <p class="help-text">
          ¿Necesitas ayuda? Contacta al administrador del sistema o revisa la documentación en el panel de configuración.
        </p>
      </div>
    </section>

  </div>
</div>