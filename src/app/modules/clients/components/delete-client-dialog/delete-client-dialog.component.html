<!-- delete-client-dialog.component.html -->

<div class="delete-dialog">
    <!-- Header -->
    <div class="dialog-header">
      <div class="warning-icon">
        <mat-icon>warning</mat-icon>
      </div>
      <h2 mat-dialog-title>‚ö†Ô∏è Confirmar Eliminaci√≥n</h2>
    </div>

    <!-- Content -->
    <mat-dialog-content class="dialog-content">
      <div class="warning-message">
        <p class="main-warning">
          Est√°s a punto de <strong>eliminar permanentemente</strong> al cliente:
        </p>

        <!-- Campos personalizados -->
        @if (customFieldsToShow().length > 0) {
          <div class="custom-fields-section">
            <div class="custom-fields-title">
              <mat-icon>info</mat-icon>
              Datos adicionales
            </div>
            <div class="custom-fields-list">
              @for (field of customFieldsToShow(); track field.id) {
                <div class="custom-field-item">
                  <span class="field-label">{{ field.label }}:</span>
                  <span class="field-value">{{ getCustomFieldValue(field) }}</span>
                </div>
              }
            </div>
          </div>
        }

        <div class="warning-list">
          <div class="warning-item">
            <mat-icon class="danger-icon">error</mat-icon>
            <span>Esta acci√≥n <strong>NO se puede deshacer</strong></span>
          </div>
          <div class="warning-item">
            <mat-icon class="danger-icon">delete_forever</mat-icon>
            <span>Se eliminar√°n todos los datos del cliente</span>
          </div>
          <div class="warning-item">
            <mat-icon class="danger-icon">block</mat-icon>
            <span>La informaci√≥n se perder√° permanentemente</span>
          </div>
        </div>

        <!-- Confirmaci√≥n de seguridad -->
        <div class="confirmation-section">
          <p class="confirmation-label">
            Para confirmar, escribe: <span class="keyword-badge">ELIMINAR</span>
          </p>

          <div class="confirmation-input-wrapper">
            <div class="input-container">
              <div class="input-icon-wrapper">
                <mat-icon class="input-icon">{{ confirmationText.toUpperCase() === 'ELIMINAR' ? 'check_circle' : 'edit' }}</mat-icon>
              </div>
              <input
                class="confirmation-input-custom"
                [(ngModel)]="confirmationText"
                [disabled]="isDeleting"
                (keyup.enter)="onConfirm()"
                placeholder="Escribe ELIMINAR aqu√≠..."
                autocomplete="off"
                [class.valid]="confirmationText.toUpperCase() === 'ELIMINAR'"
                [class.invalid]="confirmationText.length > 0 && confirmationText.toUpperCase() !== 'ELIMINAR'"
              >
            </div>
            @if (confirmationText.length > 0) {
              <div class="input-status">
                @if (confirmationText.toUpperCase() === 'ELIMINAR') {
                  <span class="status-text">
                    ‚úì Correcto
                  </span>
                } @else {
                  <span class="status-text error">
                    ‚úó Incorrecto
                  </span>
                }
              </div>
            }
          </div>

          @if (confirmationText.length === 0) {
            <div class="hint-text">
              üí° Escribe exactamente la palabra indicada para continuar
            </div>
          }
        </div>
      </div>
    </mat-dialog-content>

    <!-- Actions -->
    <mat-dialog-actions class="dialog-actions">
      <button
        mat-stroked-button
        (click)="onCancel()"
        [disabled]="isDeleting"
        class="cancel-btn">
        <mat-icon>close</mat-icon>
        Cancelar
      </button>

      <button
        mat-raised-button
        color="warn"
        (click)="onConfirm()"
        [disabled]="!canConfirm() || isDeleting"
        class="delete-btn">
        @if (isDeleting) {
          <mat-spinner diameter="20"></mat-spinner>
        } @else {
          <mat-icon>delete_forever</mat-icon>
        }
        {{ isDeleting ? 'Eliminando...' : 'Eliminar Cliente' }}
      </button>
    </mat-dialog-actions>
  </div>
